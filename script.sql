CREATE SCHEMA IF NOT EXISTS UND_ATD1;
CREATE SCHEMA IF NOT EXISTS UND_ATD2;
CREATE SCHEMA IF NOT EXISTS UND_ATD3;

-- ============================================================
-- UND_ATD1
-- ============================================================
CREATE TABLE IF NOT EXISTS UND_ATD1.FUNCOES_COLAB_UNIDADE (
    COD_ID_FUNCAO INT PRIMARY KEY,
    NOME_FUNCAO VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS UND_ATD1.COLABORADORES (
    COD_ID_COLABORADOR BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME_COLABORADOR VARCHAR(150) NOT NULL,
    COD_ID_FUNCAO INT NOT NULL,
    CONSTRAINT FK_COLAB_FUNCAO
        FOREIGN KEY (COD_ID_FUNCAO)
        REFERENCES UND_ATD1.FUNCOES_COLAB_UNIDADE (COD_ID_FUNCAO)
);

CREATE TABLE IF NOT EXISTS UND_ATD1.PONTO_MEDICOS (
    NR_SEQ_HORARIO INT PRIMARY KEY,
    COD_ID_COLABORADOR BIGINT NOT NULL,
    HORARIO_ENTRADA TIME NOT NULL,
    HORARIO_SAIDA TIME,
    CONSTRAINT FK_PONTO_MEDICO
        FOREIGN KEY (COD_ID_COLABORADOR)
        REFERENCES UND_ATD1.COLABORADORES (COD_ID_COLABORADOR)
);

CREATE TABLE IF NOT EXISTS UND_ATD1.CADASTRO_SUS (
    COD_CADASTRO_SUS_PACIENTE BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME_PACIENTE VARCHAR(150) NOT NULL,
    IDADE_PACIENTE INT NOT NULL,
    INDICADOR_GESTANTE CHAR(1) -- 'S' ou 'N'
);

CREATE TABLE IF NOT EXISTS UND_ATD1.TIPO_ESTADO_SENHA (
    COD_TIPO_ESTADO INT PRIMARY KEY,
    NOME_STATUS VARCHAR(100) NOT NULL,
    DESCRICAO_STATUS TEXT
);

CREATE TABLE IF NOT EXISTS UND_ATD1.TIPO_PRIORIZACAO (
    COD_TIPO_PRIORIZACAO INT PRIMARY KEY,
    NOME_PRIORIZACAO VARCHAR(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS UND_ATD1.ATENDIMENTOS_UNIDADE (
    NR_SEQ_ATENDIMENTO BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NR_SENHA_ATENDIMENTO INT NOT NULL,
    COD_CADASTRO_SUS_PACIENTE BIGINT NOT NULL,
    COD_TIPO_PRIORIZACAO INT NOT NULL DEFAULT 0,
    COD_ESTADO_SENHA INT NOT NULL,
    CONSTRAINT FK_ATEND_PACIENTE
        FOREIGN KEY (COD_CADASTRO_SUS_PACIENTE)
        REFERENCES UND_ATD1.CADASTRO_SUS (COD_CADASTRO_SUS_PACIENTE),
    CONSTRAINT FK_ATEND_PRIORIZACAO
        FOREIGN KEY (COD_TIPO_PRIORIZACAO)
        REFERENCES UND_ATD1.TIPO_PRIORIZACAO (COD_TIPO_PRIORIZACAO),
    CONSTRAINT FK_ATEND_ESTADO
        FOREIGN KEY (COD_ESTADO_SENHA)
        REFERENCES UND_ATD1.TIPO_ESTADO_SENHA (COD_TIPO_ESTADO)
);

CREATE TABLE IF NOT EXISTS UND_ATD1.ESTADO_ATENDIMENTO (
    NR_SEQ_ESTADO_ATENDIMENTO BIGINT GENERATED BY DEFAULT AS IDENTITY,
    NR_SEQ_ATENDIMENTO BIGINT NOT NULL,
    COD_TIPO_ESTADO INT NOT NULL,
    TIMESTAMP_ESTADO TIMESTAMP NOT NULL,
    PRIMARY KEY (NR_SEQ_ATENDIMENTO, COD_TIPO_ESTADO, TIMESTAMP_ESTADO),
    CONSTRAINT UK_ESTADO_ATENDIMENTO_SEQ UNIQUE (NR_SEQ_ESTADO_ATENDIMENTO),
    CONSTRAINT FK_ESTADO_ATENDIMENTO
        FOREIGN KEY (NR_SEQ_ATENDIMENTO)
        REFERENCES UND_ATD1.ATENDIMENTOS_UNIDADE (NR_SEQ_ATENDIMENTO),
    CONSTRAINT FK_ESTADO_TIPO
        FOREIGN KEY (COD_TIPO_ESTADO)
        REFERENCES UND_ATD1.TIPO_ESTADO_SENHA (COD_TIPO_ESTADO)
);

-- Tabelas físicas e massa mínima (UND_ATD1)
INSERT INTO UND_ATD1.TIPO_ESTADO_SENHA (COD_TIPO_ESTADO, NOME_STATUS, DESCRICAO_STATUS) VALUES
(1, 'SENHA_NORMAL_CRIADA', 'Senha criada com sucesso.'),
(2, 'SENHA_PRIORIZADA_GESTANTE', 'Senha especial para gestante.'),
(3, 'SENHA_PRIORIZADA_IDOSO', 'Senha especial para usuários com 60 anos ou mais.'),
(4, 'SENHA_PRIORIZADA_EMERGENCIA', 'Após triagem, atendimento é priorizado.'),
(5, 'INICIADO_ATENDIMENTO', 'Atendimento iniciado.'),
(6, 'ATENDIMENTO_FINALIZADO', 'Atendimento finalizado.'),
(90, 'SENHA_EXPIRADA', 'Usuário não estava presente no chamado.'),
(91, 'SENHA_CANCELADA', 'Usuário cancelou a consulta.')
ON CONFLICT (COD_TIPO_ESTADO) DO NOTHING;

INSERT INTO UND_ATD1.TIPO_PRIORIZACAO (COD_TIPO_PRIORIZACAO, NOME_PRIORIZACAO) VALUES
(0, 'NORMAL'),
(1, 'IDOSO'),
(2, 'GESTANTE'),
(3, 'EMERGENCIA')
ON CONFLICT (COD_TIPO_PRIORIZACAO) DO NOTHING;

INSERT INTO UND_ATD1.FUNCOES_COLAB_UNIDADE (COD_ID_FUNCAO, NOME_FUNCAO) VALUES
(1, 'Médico'),
(2, 'Enfermeiro'),
(3, 'Recepcionista'),
(4, 'Segurança')
ON CONFLICT (COD_ID_FUNCAO) DO NOTHING;

DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM UND_ATD1.COLABORADORES) THEN
        INSERT INTO UND_ATD1.COLABORADORES (NOME_COLABORADOR, COD_ID_FUNCAO) VALUES
        ('André Luiz Barros', 1),
        ('Beatriz Monteiro', 1),
        ('Carlos Eduardo Pires', 1),
        ('Daniela Souza', 1),
        ('Eduardo F. Almeida', 1),
        ('Fernanda Ribeiro', 1),
        ('Gabriel A. Costa', 1),
        ('Helena Martins', 1),
        ('Igor N. Oliveira', 1),
        ('Juliana Carvalho', 1),
        ('Kauã Rodrigues', 1),
        ('Larissa Nunes', 1),
        ('Marcelo Henriques', 1),
        ('Natália Araújo', 1),
        ('Otávio Pereira', 1),
        ('Paula Menezes', 1),
        ('Rafael Teixeira', 1),
        ('Sabrina Fernandes', 1),
        ('Thiago Barbosa', 1),
        ('Vanessa Lima', 1),
        ('William Santos', 1),
        ('Yasmin Ferreira', 1),
        ('Aline Campos', 2),
        ('Bruno Vieira', 2),
        ('Camila Batista', 2),
        ('Daniel Rocha', 2),
        ('Elisa Andrade', 2),
        ('Felipe Martins', 2),
        ('Giovanna Freitas', 2),
        ('Heitor Souza', 2),
        ('Isadora Costa', 2),
        ('João Vitor Pacheco', 2),
        ('Karen Lopes', 2),
        ('Leonardo Ribeiro', 2),
        ('Mariana Alves', 3),
        ('Matheus Cardoso', 3),
        ('Nicole Dias', 3),
        ('Pedro Henrique Lima', 3),
        ('Quezia Moura', 3),
        ('Renata Silva', 3),
        ('Samuel Pereira', 3),
        ('Tatiane Azevedo', 3),
        ('Ubiratan Gomes', 3),
        ('Vitória Rezende', 3),
        ('Alan Moreira', 4),
        ('Bernardo Cunha', 4),
        ('Cristiano Pinto', 4),
        ('Débora Melo', 4),
        ('Everton Farias', 4),
        ('Fábio Guimarães', 4);
    END IF;
END $$;

DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM UND_ATD1.CADASTRO_SUS) THEN
        INSERT INTO UND_ATD1.CADASTRO_SUS (NOME_PACIENTE, IDADE_PACIENTE, INDICADOR_GESTANTE) VALUES
        ('Ana Beatriz Souza', 28, 'S'),
        ('Bruno Henrique Lima', 34, 'N'),
        ('Carla Fernanda Almeida', 19, 'N'),
        ('Diego Matheus Santos', 62, 'N'),
        ('Eduarda Gomes Pereira', 25, 'S'),
        ('Felipe Augusto Rocha', 41, 'N'),
        ('Gabriela Martins Silva', 30, 'N'),
        ('Henrique Oliveira Costa', 57, 'N'),
        ('Isabela Ribeiro Nunes', 22, 'N'),
        ('João Pedro Carvalho', 66, 'N');
    END IF;
END $$;

-- ============================================================
-- UND_ATD2
-- ============================================================
CREATE TABLE IF NOT EXISTS UND_ATD2.FUNCOES_COLAB_UNIDADE (
    COD_ID_FUNCAO INT PRIMARY KEY,
    NOME_FUNCAO VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS UND_ATD2.COLABORADORES (
    COD_ID_COLABORADOR BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME_COLABORADOR VARCHAR(150) NOT NULL,
    COD_ID_FUNCAO INT NOT NULL,
    CONSTRAINT FK_COLAB_FUNCAO
        FOREIGN KEY (COD_ID_FUNCAO)
        REFERENCES UND_ATD2.FUNCOES_COLAB_UNIDADE (COD_ID_FUNCAO)
);

CREATE TABLE IF NOT EXISTS UND_ATD2.PONTO_MEDICOS (
    NR_SEQ_HORARIO INT PRIMARY KEY,
    COD_ID_COLABORADOR BIGINT NOT NULL,
    HORARIO_ENTRADA TIME NOT NULL,
    HORARIO_SAIDA TIME,
    CONSTRAINT FK_PONTO_MEDICO
        FOREIGN KEY (COD_ID_COLABORADOR)
        REFERENCES UND_ATD2.COLABORADORES (COD_ID_COLABORADOR)
);

CREATE TABLE IF NOT EXISTS UND_ATD2.CADASTRO_SUS (
    COD_CADASTRO_SUS_PACIENTE BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME_PACIENTE VARCHAR(150) NOT NULL,
    IDADE_PACIENTE INT NOT NULL,
    INDICADOR_GESTANTE CHAR(1) -- 'S' ou 'N'
);

CREATE TABLE IF NOT EXISTS UND_ATD2.TIPO_ESTADO_SENHA (
    COD_TIPO_ESTADO INT PRIMARY KEY,
    NOME_STATUS VARCHAR(100) NOT NULL,
    DESCRICAO_STATUS TEXT
);

CREATE TABLE IF NOT EXISTS UND_ATD2.TIPO_PRIORIZACAO (
    COD_TIPO_PRIORIZACAO INT PRIMARY KEY,
    NOME_PRIORIZACAO VARCHAR(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS UND_ATD2.ATENDIMENTOS_UNIDADE (
    NR_SEQ_ATENDIMENTO BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NR_SENHA_ATENDIMENTO INT NOT NULL,
    COD_CADASTRO_SUS_PACIENTE BIGINT NOT NULL,
    COD_TIPO_PRIORIZACAO INT NOT NULL DEFAULT 0,
    COD_ESTADO_SENHA INT NOT NULL,
    CONSTRAINT FK_ATEND_PACIENTE
        FOREIGN KEY (COD_CADASTRO_SUS_PACIENTE)
        REFERENCES UND_ATD2.CADASTRO_SUS (COD_CADASTRO_SUS_PACIENTE),
    CONSTRAINT FK_ATEND_PRIORIZACAO
        FOREIGN KEY (COD_TIPO_PRIORIZACAO)
        REFERENCES UND_ATD2.TIPO_PRIORIZACAO (COD_TIPO_PRIORIZACAO),
    CONSTRAINT FK_ATEND_ESTADO
        FOREIGN KEY (COD_ESTADO_SENHA)
        REFERENCES UND_ATD2.TIPO_ESTADO_SENHA (COD_TIPO_ESTADO)
);

CREATE TABLE IF NOT EXISTS UND_ATD2.ESTADO_ATENDIMENTO (
    NR_SEQ_ESTADO_ATENDIMENTO BIGINT GENERATED BY DEFAULT AS IDENTITY,
    NR_SEQ_ATENDIMENTO BIGINT NOT NULL,
    COD_TIPO_ESTADO INT NOT NULL,
    TIMESTAMP_ESTADO TIMESTAMP NOT NULL,
    PRIMARY KEY (NR_SEQ_ATENDIMENTO, COD_TIPO_ESTADO, TIMESTAMP_ESTADO),
    CONSTRAINT UK_ESTADO_ATENDIMENTO_SEQ UNIQUE (NR_SEQ_ESTADO_ATENDIMENTO),
    CONSTRAINT FK_ESTADO_ATENDIMENTO
        FOREIGN KEY (NR_SEQ_ATENDIMENTO)
        REFERENCES UND_ATD2.ATENDIMENTOS_UNIDADE (NR_SEQ_ATENDIMENTO),
    CONSTRAINT FK_ESTADO_TIPO
        FOREIGN KEY (COD_TIPO_ESTADO)
        REFERENCES UND_ATD2.TIPO_ESTADO_SENHA (COD_TIPO_ESTADO)
);

INSERT INTO UND_ATD2.TIPO_ESTADO_SENHA (COD_TIPO_ESTADO, NOME_STATUS, DESCRICAO_STATUS) VALUES
(1, 'SENHA_NORMAL_CRIADA', 'Senha criada com sucesso.'),
(2, 'SENHA_PRIORIZADA_GESTANTE', 'Senha especial para gestante.'),
(3, 'SENHA_PRIORIZADA_IDOSO', 'Senha especial para usuários com 60 anos ou mais.'),
(4, 'SENHA_PRIORIZADA_EMERGENCIA', 'Após triagem, atendimento é priorizado.'),
(5, 'INICIADO_ATENDIMENTO', 'Atendimento iniciado.'),
(6, 'ATENDIMENTO_FINALIZADO', 'Atendimento finalizado.'),
(90, 'SENHA_EXPIRADA', 'Usuário não estava presente no chamado.'),
(91, 'SENHA_CANCELADA', 'Usuário cancelou a consulta.')
ON CONFLICT (COD_TIPO_ESTADO) DO NOTHING;

INSERT INTO UND_ATD2.TIPO_PRIORIZACAO (COD_TIPO_PRIORIZACAO, NOME_PRIORIZACAO) VALUES
(0, 'NORMAL'),
(1, 'IDOSO'),
(2, 'GESTANTE'),
(3, 'EMERGENCIA')
ON CONFLICT (COD_TIPO_PRIORIZACAO) DO NOTHING;

INSERT INTO UND_ATD2.FUNCOES_COLAB_UNIDADE (COD_ID_FUNCAO, NOME_FUNCAO) VALUES
(1, 'Médico'),
(2, 'Enfermeiro'),
(3, 'Recepcionista'),
(4, 'Segurança')
ON CONFLICT (COD_ID_FUNCAO) DO NOTHING;

DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM UND_ATD2.COLABORADORES) THEN
        INSERT INTO UND_ATD2.COLABORADORES (NOME_COLABORADOR, COD_ID_FUNCAO)
        SELECT NOME_COLABORADOR, COD_ID_FUNCAO FROM UND_ATD1.COLABORADORES;
    END IF;
END $$;

DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM UND_ATD2.CADASTRO_SUS) THEN
        INSERT INTO UND_ATD2.CADASTRO_SUS (NOME_PACIENTE, IDADE_PACIENTE, INDICADOR_GESTANTE)
        SELECT NOME_PACIENTE, IDADE_PACIENTE, INDICADOR_GESTANTE FROM UND_ATD1.CADASTRO_SUS;
    END IF;
END $$;

-- ============================================================
-- UND_ATD3
-- ============================================================
CREATE TABLE IF NOT EXISTS UND_ATD3.FUNCOES_COLAB_UNIDADE (
    COD_ID_FUNCAO INT PRIMARY KEY,
    NOME_FUNCAO VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS UND_ATD3.COLABORADORES (
    COD_ID_COLABORADOR BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME_COLABORADOR VARCHAR(150) NOT NULL,
    COD_ID_FUNCAO INT NOT NULL,
    CONSTRAINT FK_COLAB_FUNCAO
        FOREIGN KEY (COD_ID_FUNCAO)
        REFERENCES UND_ATD3.FUNCOES_COLAB_UNIDADE (COD_ID_FUNCAO)
);

CREATE TABLE IF NOT EXISTS UND_ATD3.PONTO_MEDICOS (
    NR_SEQ_HORARIO INT PRIMARY KEY,
    COD_ID_COLABORADOR BIGINT NOT NULL,
    HORARIO_ENTRADA TIME NOT NULL,
    HORARIO_SAIDA TIME,
    CONSTRAINT FK_PONTO_MEDICO
        FOREIGN KEY (COD_ID_COLABORADOR)
        REFERENCES UND_ATD3.COLABORADORES (COD_ID_COLABORADOR)
);

CREATE TABLE IF NOT EXISTS UND_ATD3.CADASTRO_SUS (
    COD_CADASTRO_SUS_PACIENTE BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME_PACIENTE VARCHAR(150) NOT NULL,
    IDADE_PACIENTE INT NOT NULL,
    INDICADOR_GESTANTE CHAR(1) -- 'S' ou 'N'
);

CREATE TABLE IF NOT EXISTS UND_ATD3.TIPO_ESTADO_SENHA (
    COD_TIPO_ESTADO INT PRIMARY KEY,
    NOME_STATUS VARCHAR(100) NOT NULL,
    DESCRICAO_STATUS TEXT
);

CREATE TABLE IF NOT EXISTS UND_ATD3.TIPO_PRIORIZACAO (
    COD_TIPO_PRIORIZACAO INT PRIMARY KEY,
    NOME_PRIORIZACAO VARCHAR(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS UND_ATD3.ATENDIMENTOS_UNIDADE (
    NR_SEQ_ATENDIMENTO BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NR_SENHA_ATENDIMENTO INT NOT NULL,
    COD_CADASTRO_SUS_PACIENTE BIGINT NOT NULL,
    COD_TIPO_PRIORIZACAO INT NOT NULL DEFAULT 0,
    COD_ESTADO_SENHA INT NOT NULL,
    CONSTRAINT FK_ATEND_PACIENTE
        FOREIGN KEY (COD_CADASTRO_SUS_PACIENTE)
        REFERENCES UND_ATD3.CADASTRO_SUS (COD_CADASTRO_SUS_PACIENTE),
    CONSTRAINT FK_ATEND_PRIORIZACAO
        FOREIGN KEY (COD_TIPO_PRIORIZACAO)
        REFERENCES UND_ATD3.TIPO_PRIORIZACAO (COD_TIPO_PRIORIZACAO),
    CONSTRAINT FK_ATEND_ESTADO
        FOREIGN KEY (COD_ESTADO_SENHA)
        REFERENCES UND_ATD3.TIPO_ESTADO_SENHA (COD_TIPO_ESTADO)
);

CREATE TABLE IF NOT EXISTS UND_ATD3.ESTADO_ATENDIMENTO (
    NR_SEQ_ESTADO_ATENDIMENTO BIGINT GENERATED BY DEFAULT AS IDENTITY,
    NR_SEQ_ATENDIMENTO BIGINT NOT NULL,
    COD_TIPO_ESTADO INT NOT NULL,
    TIMESTAMP_ESTADO TIMESTAMP NOT NULL,
    PRIMARY KEY (NR_SEQ_ATENDIMENTO, COD_TIPO_ESTADO, TIMESTAMP_ESTADO),
    CONSTRAINT UK_ESTADO_ATENDIMENTO_SEQ UNIQUE (NR_SEQ_ESTADO_ATENDIMENTO),
    CONSTRAINT FK_ESTADO_ATENDIMENTO
        FOREIGN KEY (NR_SEQ_ATENDIMENTO)
        REFERENCES UND_ATD3.ATENDIMENTOS_UNIDADE (NR_SEQ_ATENDIMENTO),
    CONSTRAINT FK_ESTADO_TIPO
        FOREIGN KEY (COD_TIPO_ESTADO)
        REFERENCES UND_ATD3.TIPO_ESTADO_SENHA (COD_TIPO_ESTADO)
);

INSERT INTO UND_ATD3.TIPO_ESTADO_SENHA (COD_TIPO_ESTADO, NOME_STATUS, DESCRICAO_STATUS) VALUES
(1, 'SENHA_NORMAL_CRIADA', 'Senha criada com sucesso.'),
(2, 'SENHA_PRIORIZADA_GESTANTE', 'Senha especial para gestante.'),
(3, 'SENHA_PRIORIZADA_IDOSO', 'Senha especial para usuários com 60 anos ou mais.'),
(4, 'SENHA_PRIORIZADA_EMERGENCIA', 'Após triagem, atendimento é priorizado.'),
(5, 'INICIADO_ATENDIMENTO', 'Atendimento iniciado.'),
(6, 'ATENDIMENTO_FINALIZADO', 'Atendimento finalizado.'),
(90, 'SENHA_EXPIRADA', 'Usuário não estava presente no chamado.'),
(91, 'SENHA_CANCELADA', 'Usuário cancelou a consulta.')
ON CONFLICT (COD_TIPO_ESTADO) DO NOTHING;

INSERT INTO UND_ATD3.TIPO_PRIORIZACAO (COD_TIPO_PRIORIZACAO, NOME_PRIORIZACAO) VALUES
(0, 'NORMAL'),
(1, 'IDOSO'),
(2, 'GESTANTE'),
(3, 'EMERGENCIA')
ON CONFLICT (COD_TIPO_PRIORIZACAO) DO NOTHING;

INSERT INTO UND_ATD3.FUNCOES_COLAB_UNIDADE (COD_ID_FUNCAO, NOME_FUNCAO) VALUES
(1, 'Médico'),
(2, 'Enfermeiro'),
(3, 'Recepcionista'),
(4, 'Segurança')
ON CONFLICT (COD_ID_FUNCAO) DO NOTHING;

DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM UND_ATD3.COLABORADORES) THEN
        INSERT INTO UND_ATD3.COLABORADORES (NOME_COLABORADOR, COD_ID_FUNCAO)
        SELECT NOME_COLABORADOR, COD_ID_FUNCAO FROM UND_ATD1.COLABORADORES;
    END IF;
END $$;

DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM UND_ATD3.CADASTRO_SUS) THEN
        INSERT INTO UND_ATD3.CADASTRO_SUS (NOME_PACIENTE, IDADE_PACIENTE, INDICADOR_GESTANTE)
        SELECT NOME_PACIENTE, IDADE_PACIENTE, INDICADOR_GESTANTE FROM UND_ATD1.CADASTRO_SUS;
    END IF;
END $$;


